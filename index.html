<!DOCTYPE html>
<html>
<head>
</head>

<script>
  function genTokenData(projectNum, mintSize) {
    const wwwHashesLookedAt = JSON.parse(localStorage.getItem('wwwHashesLookedAt')) || 0

    const queryParams = window.location.search
      ? window.location.search.replace('?', '').split('&').reduce((params, i) => {
          const [k, v] = i.split('=')
          params[k] = v
          return params
        }, {})
      : {}

    let hash = '0x'
    if (queryParams.hash) {
      hash = queryParams.hash
    } else {
      for (let i = 0; i < 64; i++) {
        hash += Math.floor(Math.random() * 16).toString(16)
      }
      window.location.hash = '#' + hash

      const last10hashes = JSON.parse(localStorage.getItem('last10Hashes')) || []
      last10hashes.unshift(hash)

      localStorage.setItem('last10Hashes', JSON.stringify(last10hashes.slice(0, 10)))
      localStorage.setItem('wwwHashesLookedAt', JSON.stringify(wwwHashesLookedAt+1))
    }

    let tokenId = queryParams.tokenId
    if (!tokenId) {
      tokenId = String(projectNum * 1000000 + Math.floor(Math.random() * mintSize))
    }

    return { hash, tokenId }
  }

  const tokenData = genTokenData(999, 500)
  console.log(tokenData.hash)
</script>
<body>

</body>

<script src="./utils.js"></script>
<script src="./metadata.js"></script>
<script src="./layout.js"></script>
<script src="./index.js"></script>

</html>
